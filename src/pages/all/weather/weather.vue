<template>
    <div id="content-component">
        <!--<div>{{this.$route.query.ti}}</div>-->
        <div class="demo-grid margin-top">
            <mu-row gutter>
                <mu-col width="100" tablet="100" desktop="100" class="center-weather">
                   <svg class="icon" style="width: 20%; height: 20%;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="593"><path d="M511.998984 252.156591c143.962229 0 260.171479 116.20925 260.171478 260.171479s-116.20925 260.171479-260.171478 260.171479-260.171479-116.20925-260.171479-260.171479 116.211282-260.171479 260.171479-260.171479" fill="#FFE079" p-id="594"></path><path d="M303.861801 1024h-3.469631c-3.469631-1.733799-5.20343-5.20343-5.203429-8.67306v-3.469631l29.486778-71.114215c1.733799-5.20343 6.937229-6.937229 12.140658-5.203429 3.469631 1.733799 5.20343 5.20343 5.20343 8.67306v3.46963l-29.486779 71.114215c-1.731766 3.467598-5.201397 5.20343-8.671027 5.20343z m416.274366-1.735832c-3.469631 0-6.937229-1.733799-8.67306-5.203429L681.978361 947.682355v-3.46963c0-3.469631 1.733799-6.937229 5.203429-8.67306 5.20343-1.733799 8.67306 0 12.140658 5.203429l29.486779 69.378384v3.46963c0 3.469631-1.733799 6.937229-5.20343 8.67306h-3.46963z m-208.137183-32.954376c-5.20343 0-8.67306-3.469631-8.67306-8.67306v-138.7588c0-5.20343 3.469631-8.67306 8.67306-8.67306s8.67306 3.469631 8.67306 8.67306v138.7588c0 5.20343-3.469631 8.67306-8.67306 8.67306z m152.635289-100.598961c-3.469631 0-6.937229-1.733799-8.67306-5.20343l-26.017148-64.174953v-3.469631c0-3.469631 1.733799-6.937229 5.203429-8.67306 5.20343-1.733799 8.67306 0 12.140659 5.203429l26.017148 64.174954v3.469631c0 3.469631-1.733799 6.937229-5.20343 8.67306h-3.467598z m-305.268546 0h-3.469631c-3.469631-1.733799-5.20343-5.20343-5.203429-8.67306v-3.469631l26.017148-64.174954c1.733799-5.20343 6.937229-6.937229 12.140658-5.203429 3.469631 1.733799 5.20343 5.20343 5.203429 8.67306v3.469631l-26.017147 64.174953c-1.733799 3.467598-5.201397 5.20343-8.671028 5.20343zM187.652551 854.020623c-1.733799 0-5.20343 0-6.937228-1.733799s-1.733799-3.469631-1.733799-6.937229 0-5.20343 1.733799-6.937228l98.865161-98.865162c3.469631-3.469631 8.67306-3.469631 12.140659 0 1.733799 1.733799 1.733799 3.469631 1.733799 6.937229s0 5.20343-1.733799 6.937228l-98.865162 98.865162c-1.733799 1.733799-3.469631 1.733799-5.20343 1.733799z m660.835556 0c-1.733799 0-5.20343 0-6.937229-1.733799l-98.865161-98.865162c-1.733799-1.733799-1.733799-3.469631-1.733799-6.937228s0-5.20343 1.733799-6.937229c3.469631-3.469631 8.67306-3.469631 12.140658 0L853.691537 838.410334c1.733799 1.733799 1.733799 3.469631 1.733799 6.937229s0 5.20343-1.733799 6.937228c-1.733799 1.735832-1.733799 1.735832-5.20343 1.735832z m-336.489123-72.848014c-147.429827 0-268.844539-121.412679-268.844539-268.844539s121.412679-268.844539 268.844539-268.844539S780.843523 364.898243 780.843523 512.32807 659.430843 781.172609 511.998984 781.172609z m0-520.342957c-138.7588 0-251.498419 112.741652-251.498419 251.498418s112.741652 251.498419 251.498419 251.498419 251.498419-112.741652 251.498418-251.498419S650.757783 260.829652 511.998984 260.829652z m502.998869 468.308661h-3.46963l-71.114215-29.486778c-3.469631-1.733799-5.20343-5.20343-5.20343-8.67306v-3.469631c1.733799-5.20343 6.937229-6.937229 12.140658-5.203429l71.114215 29.486778c3.469631 1.733799 5.20343 5.20343 5.20343 8.67306v3.469631c-1.733799 3.469631-5.201397 5.20343-8.671028 5.203429z m-1005.995706 0c-3.469631 0-6.937229-1.733799-8.673061-5.203429v-3.469631c0-3.469631 1.733799-6.937229 5.20343-8.67306l71.114215-29.486778c5.20343-1.733799 8.67306 0 12.140658 5.203429v3.469631c0 3.469631-1.733799 6.937229-5.203429 8.67306L12.469745 729.138313H9.002147zM879.708684 673.634387h-3.46963l-64.174954-26.017148c-3.469631-1.733799-5.20343-5.20343-5.20343-8.67306v-3.469631c1.733799-5.20343 6.937229-6.937229 12.140659-5.203429l64.174953 26.017148c3.469631 1.733799 5.20343 5.20343 5.20343 8.67306v3.46963c-1.733799 3.469631-5.201397 5.20343-8.671028 5.20343z m-735.417368 0c-3.469631 0-6.937229-1.733799-8.673061-5.20343v-3.46963c0-3.469631 1.733799-6.937229 5.20343-8.67306l64.174954-26.017148c5.20343-1.733799 8.67306 0 12.140658 5.203429v3.469631c0 3.469631-1.733799 6.937229-5.20343 8.67306l-64.174953 26.017148h-3.467598z m836.016329-152.633257h-138.758799c-5.20343 0-8.67306-3.469631-8.67306-8.67306 0-5.20343 3.469631-8.67306 8.67306-8.67306h138.758799c5.20343 0 8.67306 3.469631 8.673061 8.67306 0 5.20343-3.469631 8.67306-8.673061 8.67306z m-797.858523 0H43.690322c-5.20343 0-8.67306-3.469631-8.67306-8.67306 0-5.20343 3.469631-8.67306 8.67306-8.67306H182.449122c5.20343 0 8.67306 3.469631 8.67306 8.67306 0 5.20343-3.469631 8.67306-8.67306 8.67306z m499.529239-86.724503c-3.469631 0-6.937229-1.733799-6.937229-5.20343-13.87649-27.750947-36.424007-52.034296-62.441155-71.114215-3.469631-3.469631-5.20343-8.67306-1.733799-12.140658 3.469631-3.469631 8.67306-5.20343 12.140658-1.733799 29.486778 19.079919 53.768095 45.097067 69.378384 76.317644 1.733799 3.469631 0 8.67306-3.469631 12.140659-3.467598 1.733799-5.20343 1.733799-6.937228 1.733799z m-475.245891-39.891605H203.26284l-64.174954-26.017148c-3.469631-1.733799-5.20343-5.20343-5.20343-8.673061v-3.46963c1.733799-5.20343 6.937229-6.937229 12.140659-5.20343l64.174953 26.017148c3.469631 1.733799 5.20343 5.20343 5.20343 8.67306v3.469631c-1.733799 3.467598-5.20343 5.20343-8.671028 5.20343z m610.53506 0c-3.469631 0-6.937229-1.733799-8.673061-5.20343v-3.469631c0-3.469631 1.733799-6.937229 5.20343-8.67306l64.174954-26.017148c5.20343-1.733799 8.67306 0 12.140658 5.20343v3.46963c0 3.469631-1.733799 6.937229-5.20343 8.673061l-64.174953 26.017148h-3.467598z m126.616108-52.034296c-3.469631 0-6.937229-1.733799-8.67306-5.20343v-3.46963c0-3.469631 1.733799-6.937229 5.20343-8.673061l71.114215-29.486778c5.20343-1.733799 8.67306 0 12.140658 5.20343v3.46963c0 3.469631-1.733799 6.937229-5.20343 8.67306l-71.114215 29.486779h-3.467598z m-863.769309 0h-3.469631L5.532516 312.863947c-3.469631-1.733799-5.20343-5.20343-5.20343-8.67306v-3.46963c1.733799-5.20343 6.937229-6.937229 12.140659-5.20343l71.114215 29.486778c3.469631 1.733799 5.20343 5.20343 5.203429 8.673061v3.46963c-3.469631 3.467598-5.20343 5.20343-8.67306 5.20343z m671.242415-52.034296c-1.733799 0-5.20343 0-6.937228-1.733799-1.733799-1.733799-1.733799-3.469631-1.733799-6.937229s0-5.20343 1.733799-6.937228l84.988672-84.988672c3.469631-3.469631 8.67306-3.469631 12.140658 0 1.733799 1.733799 1.733799 3.469631 1.733799 6.937228 0 3.469631 0 5.20343-1.733799 6.937229l-84.988672 84.988672c-1.733799 1.733799-3.467598 1.733799-5.20343 1.733799z m-466.57283 0c-1.733799 0-5.20343 0-6.937229-1.733799l-98.865161-98.865162c-1.735832-1.735832-1.735832-3.469631-1.735832-6.939261s0-5.20343 1.733799-6.937229c3.469631-3.469631 8.67306-3.469631 12.140658 0l98.865162 98.865162c1.733799 1.733799 1.733799 3.469631 1.733799 6.937229s0 5.20343-1.733799 6.937228c-1.733799 1.735832-3.467598 1.735832-5.201397 1.735832z m100.598961-74.583846c-3.469631 0-6.937229-1.733799-8.67306-5.203429L350.692667 146.354201v-3.469631c0-3.469631 1.733799-6.937229 5.203429-8.67306 5.20343-1.733799 8.67306 0 12.140659 5.20343l26.017147 64.174954v3.46963c0 3.469631-1.733799 6.937229-5.203429 8.67306H385.382875z m253.23425 0h-3.469631c-3.469631-1.733799-5.20343-5.20343-5.203429-8.67306v-3.46963l26.017148-64.174954c1.733799-5.20343 6.937229-6.937229 12.140658-5.20343 3.469631 1.733799 5.20343 5.20343 5.20343 8.67306V146.354201l-26.017148 64.174954c-1.733799 3.469631-5.20343 5.20343-8.671028 5.203429z m-126.618141-24.281316c-5.20343 0-8.67306-3.469631-8.67306-8.67306V61.365529c0-5.20343 3.469631-8.67306 8.67306-8.67306s8.67306 3.469631 8.67306 8.67306V182.778208c0 5.20343-3.469631 8.67306-8.67306 8.67306zM333.348579 89.116476c-3.469631 0-6.937229-1.733799-8.67306-5.20343L295.190773 12.798831V9.3292c0-3.469631 1.733799-6.937229 5.20343-8.67306 5.20343-1.733799 8.67306 0 12.140658 5.20343l29.486778 71.114215v3.46963c0 3.469631-1.733799 6.937229-5.203429 8.673061-1.735832-1.733799-3.469631 0-3.469631 0z m357.302842 0h-3.469631c-3.469631-1.733799-5.20343-5.20343-5.203429-8.673061v-3.46963L711.465139 5.861602C713.198938 0.658173 718.402368-1.075626 723.605797 0.658173c3.469631 1.733799 5.20343 5.20343 5.20343 8.67306v3.469631L699.322448 83.913046c-1.733799 1.733799-5.20343 5.20343-8.671027 5.20343z" fill="#51565F" p-id="595"></path></svg>
                </mu-col>
            </mu-row>
            <br>
            <mu-row gutter>
                <mu-col width="100" tablet="100" desktop="100" class="center-weather">
                    <mu-auto-complete hintText="城市名称,例如：北京"
                                      filter="caseInsensitiveFilter"
                                      openOnFocus
                                      labelFloat
                                      @input="UserInput"
                                      fullWidth
                                      :dataSource="dataSource"/>
                </mu-col>
            </mu-row>
        </div>

        <div class="demo-grid">
            <mu-row gutter>
                <mu-col width="100" tablet="100" desktop="100" class="center-weather">
                    <small class="NoError" v-if="NoCity" inset>没有数据</small>

                    <!--<p>{{ YouCityWeather }}</p>-->

                    <mu-card v-else>
                        <mu-list>
                            <mu-list-item v-for="data, index in YouCityWeather.YouCityWeatherWeatherData"
                                    :title="data.date"
                                    :key="index"
                                    describeLine="3"
                                    :describeText="data.temperature +' | ' +data.weather+ ' | ' +data.wind ">
                                <mu-avatar slot="leftAvatar" >
                                    <img width="50" :src="data.dayPictureUrl" alt="data.date">
                                </mu-avatar>
                            </mu-list-item>

                        </mu-list>
                    </mu-card>

                </mu-col>
            </mu-row>
        </div>


    </div>

</template>

<script>
import City from './weather.js'

export default{

  mounted () {
      this.$SetTitle(this.$route.query.ti)
      this.NoCity = true
  },
  data () {
    return {
        dataSource: City.CityData(),
        YouCityWeather: {
            YouCityWeatherCurrentCity: '',
            YouCityWeatherPm25: '',
            YouCityWeatherWeatherData: {},
        },
        NoCity: false
    }
  },
  methods: {
      UserInput(val){
          if(val){
              this.$http.jsonp(this.$WeatherApiUrl(val))
                  .then(function (success) {
                      if(success.body.status == "No result available"){
                          this.NoCity = true
                      }else {
                          this.YouCityWeather.YouCityWeatherCurrentCity = success.body.results[0].currentCity
                          this.YouCityWeather.YouCityWeatherPm25 = success.body.results[0].pm25
                          this.YouCityWeather.YouCityWeatherWeatherData = success.body.results[0].weather_data
                          this.NoCity = false
                      }
                  },function (error) {
                      console.log(error)
                  })
          }else {
              this.NoCity = true
          }
      }
  }
}
</script>

<style scoped>
.mu-card{
    box-shadow:0 0 0 rgba(255, 255, 255, 0);
}
.NoError{
    color: #cbcbcb;
}
.center-weather{
    text-align: center;
    margin: 5px;
}
.margin-top{
    padding-top: 15%;
}
</style>
